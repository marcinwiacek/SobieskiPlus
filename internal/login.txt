<table width=100% border=0><tr><td>
<script src="external/sha256.js"></script>
<script>
  var hash='<!--HASH-->';
</script>
  <form method=post id=login name=login>
      Użytkownik: <input name="user" type="text" id="user" value=""><br>
      Hasło: <input name="password" type="text" id="password" value="">
      <button type="submit" id="loginsub" style='cursor: pointer;'>Login</button>
  </form>
  <br>albo<p>
  <a href=?q=logingoogle>Loguj przez Google</a>
<script>
document.getElementById('loginsub').disabled=true;
function sprawdzlogin() {
  if (document.getElementById("login").elements.namedItem("user").value=="" ||
      document.getElementById("login").elements.namedItem("password").value=="") {
    document.getElementById('loginsub').disabled=true;
  } else {
    document.getElementById('loginsub').disabled=false;
  }
}
document.getElementById("user").addEventListener("input", sprawdzlogin);
document.getElementById("password").addEventListener("input", sprawdzlogin);


document.login.onsubmit = function() {
  var user = document.getElementById("login").elements.namedItem("user").value; 
  var password = document.getElementById("login").elements.namedItem("password").value; 

  if (user == '' || password == '') return false;

  var http = new XMLHttpRequest();
  var url = window.location.protocol+'//'+window.location.hostname+':'+window.location.port+window.location.pathname;
  var params = "login=1&user="+sha256(hash+user)+"&password="+sha256(hash+sha256(password));

  http.open('POST', url, true);
  http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
  http.onload = function() {
    if (http.status != 200) {
      alert('login error ' + http.response);
    } else {
      window.location.reload();
    }
  };
  http.onerror = function () {
    alert('login error');
  };

  http.send(params);
  return false;
};
</script>
</td></tr></table>
