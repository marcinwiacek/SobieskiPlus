
<!-- we need something with Polish dictionary -->

<link type="text/css" rel="stylesheet" href="templates/quill.snow.css">
<script src="templates/quill.min.js"></script>

<table width=100% border=1><tr><td>
  <form id=commentedit name=commentedit>
      Tytuł: <input name="display_name" type="text" value="">
      <input name="about" type="hidden">
      <div id="editor-container"></div>
      <button type="submit">Dodaj komentarz</button>
  </form>
</td></tr></table>
Postęp: <progress id="progress" value="0"></progress>
<script async=async>

var toolbarOptions = [
  ['bold', 'italic', 'underline', 'strike'],
  ['blockquote', 'code-block', 'image'],

  [{ 'header': 1 }, { 'header': 2 }],
  [{ 'list': 'ordered'}, { 'list': 'bullet' }],
  [{ 'script': 'sub'}, { 'script': 'super' }],
  [{ 'indent': '-1'}, { 'indent': '+1' }],
  [{ 'direction': 'rtl' }],

  [{ 'size': ['small', false, 'large', 'huge'] }],
  [{ 'header': [1, 2, 3, 4, 5, 6, false] }],

  [{ 'color': [] }, { 'background': [] }],
  [{ 'font': [] }],
  [{ 'align': [] }],

  ['clean']
];

var quill = new Quill('#editor-container', {
  modules: {
    toolbar: toolbarOptions
  },
  placeholder: 'Zapodaj ładny komentarz proszę...',
  theme: 'snow'
});

document.commentedit.onsubmit = function() {
  var progressBar = document.getElementById("progress");
  var http = new XMLHttpRequest();
  var url = window.location.protocol+'/'+window.location.hostname+':'+window.location.port+window.location.pathname;
  var params = 'q=upload_comment&tekst=3&comment='+decodeURIComponent(quill.root.innerHTML);

  http.open('POST', url, true);
  http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');

  http.onprogress = function(e) {
    if (e.lengthComputable) {
        progressBar.max = e.total;
        progressBar.value = e.loaded;
    }
  };
  http.onloadstart = function(e) {
    progressBar.value = 0;
  };
  http.onloadend = function(e) {
    progressBar.value = e.loaded;
  };
  http.send(params);

  return false;
};

</script>
