<!doctype html>
<html><head>
<meta charset='utf-8'>
<title><!--TITLE--></title>
<link rel='stylesheet' type='text/css' href='styles.css'>
</head><body>
<!--MENU-->
<div class=content>

<!--TITLE-->
<table width=100% border=1><tr><td>
<!--USER-->: <!--TYPE-->,<!--SPECIES--><p>
</td></tr></table>
<p>
<table width=100% border=1><tr><td>
<center><h1><!--TITLE--></h1></center>
<hr>
<!--TEXT-->
</td></tr></table>
<p>
<!--COMMENTS-->
<div id=newcomments></div>
<p>
<!--COMMENTEDIT-->
<!--JS-->

<!-- pooling is bad -->
<!--
function updatePage() {
  var lastUpdate = <!--LASTUPDATE-->;
  var http = new XMLHttpRequest();
  var url = window.location.protocol+'//'+window.location.hostname+':'+window.location.port+window.location.pathname;
  var params = 'q=get_page_updates&lastUpdate='+lastUpdate+'&tekstID=<!--PAGEID-->';

  http.open('POST', url, true);
  http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');

  http.onreadystatechange = function() {
       if (this.readyState == 4 && this.status == 200) {
          document.getElementById("newcomments").innerHTML += this.responseText;
       } else {
          alert('other');
       }
  //  setTimeout(updatePage, 2000);
    };

  http.send(params);
}
//    setTimeout(updatePage, 10000);
-->

<script>
  <!-- SSE is a little better -->
  var source = new EventSource("push.php?fileid=<!--PAGEID-->");
  source.onmessage = function(event) {
    if (event.data!='') {
      //parsing
      document.getElementById("newcomments").innerHTML += decodeURIComponent(event.data);
      if (document.hidden && window.document.title.substring(0,2)!="* ") {
        window.document.title = "* "+window.document.title;
      }
    }
  };
  document.body.onunload = function(){source.close();};
</script>
</body></html>